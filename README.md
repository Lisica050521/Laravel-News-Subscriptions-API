# üì¨ LARAVEL NEWS SUBSCRIPTIONS API
**RESTful API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∞–º–∏ –Ω–∞ –Ω–æ–≤–æ—Å—Ç–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (v1 –∏ v2)**

---

## üìå –û –ü–†–û–ï–ö–¢–ï

API —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ –¥–ª—è —Å–∏—Å—Ç–µ–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∞–º–∏ –Ω–∞ –Ω–æ–≤–æ—Å—Ç–Ω—ã–µ —Ä—É–±—Ä–∏–∫–∏ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é:

- ‚úâÔ∏è **–ì–∏–±–∫–æ–π –ø–æ–¥–ø–∏—Å–∫–∏** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ email –Ω–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- üîê **–ë–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è** –ø–æ–¥–ø–∏—Å–∫–∞–º–∏ —á–µ—Ä–µ–∑ —Ç–æ–∫–µ–Ω—ã –¥–æ—Å—Ç—É–ø–∞
- üìä **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ–π –≤—ã–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö** —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π (limit/offset)
- üîÑ **–ú—É–ª—å—Ç–∏—Ñ–æ—Ä–º–∞—Ç–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞** (JSON/XML)

**–ö–ª—é—á–µ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**

1. **–†–∞—Å—Å—ã–ª–∫–∞ –Ω–æ–≤–æ—Å—Ç–µ–π (IT-–∫–æ–º–ø–∞–Ω–∏–∏, –º–µ–¥–∏–∞-—Ä–µ—Å—É—Ä—Å—ã)**
    - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–¥–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (`tech`, `business`, `sports`)
    - –ü–æ–ª—É—á–∞—é—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Å—Å—ã–ª–∫–∏ –¥–ª—è –æ—Ç–ø–∏—Å–∫–∏
    - –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —á–µ—Ä–µ–∑ API

---

## ‚öôÔ∏è –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –•–ê–†–ê–ö–¢–ï–†–ò–°–¢–ò–ö–ò

### –û—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª
- ‚úÖ –ü–æ–¥–ø–∏—Å–∫–∞/–æ—Ç–ø–∏—Å–∫–∞ –Ω–∞ —Ä—É–±—Ä–∏–∫–∏
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ JWT-—Ç–æ–∫–µ–Ω—ã
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥—è—â–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- ‚úÖ –ü–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–æ–≤–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ (PHPUnit)
- üê≥ –ì–æ—Ç–æ–≤–∞—è Docker-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
---

## üõ† –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –æ–∫—Ä—É–∂–µ–Ω–∏—é

### –ë–∞–∑–æ–≤—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- PHP 8.2
- PostgreSQL 13+
- Composer 2.5+
- Laravel 10

### –î–ª—è Docker-—Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
- Docker 20.10+
- Docker Compose 2.4+

---


## üöÄ –ü–æ–ª–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ

### 1. **–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞** (–±–µ–∑ Docker)

#### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
git clone https://github.com/Lisica050521/Laravel-News-Subscriptions-API.git
cd Laravel-News-Subscriptions-API
```

#### –û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```bash
composer install
composer require doctrine/dbal laravel/sanctum spatie/laravel-xml spatie/array-to-xml
```
#### –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—Ä–∞–π–≤–µ—Ä–∞ PostgreSQL
```bash
php -m | grep pgsql
```
#### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–°–æ–∑–¥–∞–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω–æ–π –ë–î
```bash
psql -U postgres -c "CREATE DATABASE laravel_news;"
psql -U postgres -c "GRANT ALL PRIVILEGES ON DATABASE laravel_news TO –≤–∞—à_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å;"
```
–°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–π –ë–î
```bash
psql -U postgres -c "CREATE DATABASE laravel_news_api_test;"
psql -U postgres -c "GRANT ALL PRIVILEGES ON DATABASE laravel_news_api_test TO –≤–∞—à_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å;"
```

#### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
–°–æ–∑–¥–∞–π—Ç–µ `.env` —Ñ–∞–π–ª —Å–æ —Å–ª–µ–¥—É—é—â–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:
```ini
APP_NAME=Laravel
APP_ENV=local
APP_KEY=–≤–∞—à —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥
APP_DEBUG=true
APP_URL=http://localhost:8080 (–≤–∞—à –ø–æ—Ä—Ç)

DB_CONNECTION=pgsql
DB_HOST=127.0.0.1
DB_PORT=5432
DB_DATABASE=laravel_news
DB_USERNAME=–≤–∞—à_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
DB_PASSWORD=–≤–∞—à_–ø–∞—Ä–æ–ª—å

SESSION_DRIVER=cookie
SESSION_DOMAIN=localhost
SANCTUM_STATEFUL_DOMAINS=localhost:8080
SESSION_SECURE_COOKIE=false
```

#### 4. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–∞
```bash
php artisan key:generate
```
–ú–∏–≥—Ä–∞—Ü–∏–∏ –∏ —Å–∏–¥—ã
```bash
php artisan migrate --seed
```
#### 6. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Sanctum
```bash
php artisan vendor:publish --provider="Laravel\Sanctum\SanctumServiceProvider"
php artisan migrate:status | grep personal_access_tokens
```

#### 7. –¢–µ—Å—Ç–æ–≤–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
–°–æ–∑–¥–∞–π—Ç–µ `.env.testing`:
```ini
APP_NAME=Laravel
APP_ENV=testing
APP_KEY=–≤–∞—à —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥
APP_DEBUG=true
APP_URL=http://localhost:8080 (–≤–∞—à –ø–æ—Ä—Ç)

APP_ENV=testing
DB_DATABASE=laravel_news_api_test
SESSION_DRIVER=array
CACHE_DRIVER=array
QUEUE_CONNECTION=sync

SESSION_DRIVER=array
CACHE_DRIVER=array
QUEUE_CONNECTION=sync

```

#### –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤–æ–π –ë–î:
```bash
php artisan migrate:fresh --seed --env=testing
```

---

### üî• –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

#### –û—Å–Ω–æ–≤–Ω–æ–π —Ä–µ–∂–∏–º

```bash
php artisan serve --port=8080
```

#### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
php artisan test
```
---

## 2. **üê≥ Docker-—É—Å—Ç–∞–Ω–æ–≤–∫–∞**

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ–∫—Ä—É–∂–µ–Ω–∏—è

#### –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ `.env`:
```diff
 DB_HOST=db
```

#### –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ `.env.testing`:
```diff
 DB_HOST=db_test
```

### Docker-–∫–æ–º–∞–Ω–¥—ã


1. **–°–±–æ—Ä –∏ –∑–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤**:
   ```bash
   docker-compose up -d --build
   ```

2. **–£—Å—Ç–∞–Ω–∞–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π**:
   ```bash
   docker-compose run --rm composer install
   ```

3. **–ú–∏–≥—Ä–∞—Ü–∏–∏ –∏ —Å–∏–¥—ã –¥–ª—è –æ—Å–Ω–æ–≤–Ω–æ–π –ë–î**:
   ```bash
   docker-compose exec app php artisan migrate --seed
   ```

4. **–ú–∏–≥—Ä–∞—Ü–∏–∏ –∏ —Å–∏–¥—ã –¥–ª—è –æ—Å–Ω–æ–≤–Ω–æ–π —Ç–µ—Å—Ç–æ–≤–æ–π –ë–î**:
   ```bash
   docker-compose exec app php artisan migrate --seed --env=testing
   ```

5. **–ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤**:
   ```bash
   docker-compose exec app php artisan test
   ```
---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API

### –í–µ—Ä—Å–∏—è 1 (–±–∞–∑–æ–≤–∞—è)
```http
POST /api/v1/subscriptions
Content-Type: application/json
Authorization: Bearer {token}

{
  "email": "user@example.com",
  "category": "technology"
}
```

### –í–µ—Ä—Å–∏—è 2 (—Å –∫–ª—é—á–∞–º–∏ –æ—Ç–ø–∏—Å–∫–∏)
```http
POST /api/v2/subscriptions
Content-Type: application/json
Authorization: Bearer {token}

{
  "email": "user@example.com",
  "category": "technology",
  "name": "Irina Balerina"
}
```

---

## üèó –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```
laravel-news-api/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ Http/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Controllers/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Api/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ V1/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ SubscriptionController.php
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ V2/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ SubscriptionController.php
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AuthController.php
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Controller.php
```

---

## üí° –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏
1. –î–ª—è XML-–æ—Ç–≤–µ—Ç–æ–≤ –¥–æ–±–∞–≤—å—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫:
   ```
   Accept: application/xml
   ```
2. –í—Å–µ —Ç–µ—Å—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ—Ç–¥–µ–ª—å–Ω—É—é –ë–î –∏ –Ω–µ –≤–ª–∏—è—é—Ç –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω
3. –î–µ–º–æ-–¥–∞–Ω–Ω—ã–µ –≤–∫–ª—é—á–∞—é—Ç:
    - 10 —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    - 5 –∫–∞—Ç–µ–≥–æ—Ä–∏–π –Ω–æ–≤–æ—Å—Ç–µ–π
    - –ü—Ä–∏–º–µ—Ä—ã –ø–æ–¥–ø–∏—Å–æ–∫
